# Ethers Scripts

A collection of Ethereum development scripts using ethers.js v6 for interacting with the Ethereum blockchain. This project follows the Buidl Guidl's Web2 to Web3 Curriculum [Week 2, Day 1: Scripting and Smart Contracts! Providers, Signers, and Wallets](https://www.youtube.com/watch?v=m2AJAcWk394&list=PLJz1HruEnenAf80uOfDwBPqaliJkjKg69&index=7). Since the original video is from 2022, this repository contains updated code examples compatible with ethers.js v6.

## Overview

This repository contains practical examples of Ethereum blockchain interactions using ethers.js v6, including:

- **Provider Setup**: Connecting to Ethereum networks via Infura
- **Wallet Management**: Creating and managing wallets
- **Balance Queries**: Checking ETH balances
- **Transaction Sending**: Sending ETH transactions
- **Message Signing**: Signing and verifying messages

## Project Structure

```
ethers-scripts/
├── package.json          # Dependencies and scripts
├── providers.js          # Provider setup and balance queries
├── wallets.js           # Wallet creation and HD wallet generation
├── walletOps.js         # Wallet operations (signing, transactions)
├── .env                 # Environment variables (create this)
└── README.md           # This file
```

## Setup

### Prerequisites

- Node.js (v16 or higher)
- npm or yarn
- An Infura API key

### Installation

1. Clone the repository:
```bash
git clone <repository-url>
cd ethers-scripts
```

2. Install dependencies:
```bash
npm install
```

3. Create a `.env` file in the root directory:
```env
# Your Infura API key
INFURA_KEY=

# Private key from one of the accounts generated by wallets.js
WALLET_PRIVATE_KEY=

# Public address corresponding to the WALLET_PRIVATE_KEY
WALLET_PUBLIC_ADDRESS=

# Destination address for sending ETH transactions
TO_ADDRESS=
```

## Scripts

### providers.js

Demonstrates provider setup and basic blockchain queries:

- Connecting to Ethereum networks via Infura
- Resolving ENS names to addresses
- Looking up ENS names from addresses
- Checking ETH balances
- Comparing balances between addresses

**Run with:**
```bash
node providers.js
```

**Features:**
- Provider instantiation with Infura
- ENS resolution (`atg.eth` → address)
- Reverse ENS lookup (address → ENS name)
- Balance comparison between two addresses
- BigInt arithmetic for balance calculations

### wallets.js

Demonstrates wallet creation and HD wallet generation:

- Creating random wallets with mnemonics
- Generating multiple accounts from a single mnemonic phrase
- HD wallet derivation using BIP-44 paths

**Run with:**
```bash
node wallets.js
```

**Features:**
- Random wallet generation with mnemonic phrase
- HD wallet derivation (10 accounts from same mnemonic)
- BIP-44 path generation for different account indices
- Private key and address generation for each account

### walletOps.js

Demonstrates wallet operations and transaction functionality:

- Message signing and verification
- Sending ETH transactions
- Connecting wallets to providers
- Balance checking and transaction confirmation

**Run with:**
```bash
node walletOps.js
```

**Features:**
- Message signing and verification
- Transaction sending on Sepolia testnet
- Balance checking before transactions
- Transaction confirmation waiting
- Provider-connected wallet operations

## Key Concepts

### BigInt vs BigNumber

In ethers v6, balance values are returned as **BigInt** instead of BigNumber objects:

```javascript
// ✅ Correct (ethers v6)
const balance = await provider.getBalance(address);
if (balance1 > balance2) { /* ... */ }
const newBalance = balance + ethers.parseEther("1.5");

// ❌ Incorrect (ethers v5 style)
if (balance1.gt(balance2)) { /* ... */ }
const newBalance = balance.add(ethers.parseEther("1.5"));
```

### Provider Setup

```javascript
const infuraUrl = `https://mainnet.infura.io/v3/${process.env.INFURA_KEY}`;
const provider = new ethers.JsonRpcProvider(infuraUrl);
```

### Wallet Creation

```javascript
// From private key
const wallet = new ethers.Wallet(privateKey);

// Random wallet
const randomWallet = ethers.Wallet.createRandom();

// HD wallet from mnemonic
const hdWallet = ethers.HDNodeWallet.fromPhrase(mnemonic, undefined, path);
```

## Environment Variables

| Variable | Description | Example |
|----------|-------------|---------|
| `INFURA_KEY` | Your Infura API key | `abc123def456...` |
| `WALLET_PRIVATE_KEY` | Private key for transactions | `0x0000000000000000000000000000000000000000000000000000000000000000` |

## Dependencies

- **ethers**: ^6.14.1 - Ethereum library for JavaScript
- **dotenv**: ^16.5.0 - Environment variable management

## Networks

The scripts are configured to work with:

- **Mainnet**: For balance queries and ENS resolution
- **Sepolia**: For transaction testing (testnet)

## Common Issues

### BigInt Arithmetic Errors

If you see "Cannot mix BigInt and other types" errors:

```javascript
// ❌ Wrong
const result = balance / 10;

// ✅ Correct
const result = balance / 10n;
```

### Private Key Format

Ensure your private key in `.env` is clean:

```env
# ❌ Wrong (with quotes)
WALLET_PRIVATE_KEY="0x0000000000000000000000000000000000000000000000000000000000000000"

# ✅ Correct (no quotes)
WALLET_PRIVATE_KEY=0x0000000000000000000000000000000000000000000000000000000000000000
```

## Contributing

Feel free to submit issues and enhancement requests!

## License

MIT License
